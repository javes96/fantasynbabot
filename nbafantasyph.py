
from flask import Flask import requests import os from datetime import datetime, timedelta app = Flask(__name__) # Load your bot credentials from environment variables BOT_TOKEN = os.getenv("BOT_TOKEN") CHAT_ID = os.getenv("CHAT_ID") # Use @channelusername or chat_id def get_yesterday_date(): return (datetime.utcnow() - timedelta(days=1)).strftime("%Y-%m-%d") def fetch_stats(): date = get_yesterday_date() url = f"https://www.balldontlie.io/api/v1/stats?per_page=10&dates[]={date}" response = requests.get(url) data = response.json().get("data", []) if not data: return f"No games recorded on {date}." message = f"🏀 *Top Fantasy Stats for {date}*\n\n" for player in data: name = f"{player['player']['first_name']} {player['player']['last_name']}" team = player['team']['abbreviation'] pts, reb, ast, fg3m = player['pts'], player['reb'], player['ast'], player['fg3m'] stats = f"{pts} pts, {reb} reb, {ast} ast, {fg3m} 3PM" message += f"🔥 *{name}* ({team}) – {stats}\n" return message def post_to_telegram(message): url = f"https://api.telegram.org/bot{BOT_TOKEN}/sendMessage" payload = { "chat_id": CHAT_ID, "text": message, "parse_mode": "Markdown" } response = requests.post(url, json=payload) return response.status_code @app.route("/", methods=["GET"]) def run_bot(): try: message = fetch_stats() status = post_to_telegram(message) return 
